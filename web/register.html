<!doctype html>
<html lang="sv">
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Registrera – X‑Matches</title>
<style>
  :root{ --ink:#0a2540; --muted:#4c5d73; --primary:#1e66ff; }
  html,body{ height:100% }
  body{
    margin:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial; color:var(--ink);
    background:url('/media/cum.jpeg') center/cover no-repeat fixed; /* embedded image */
  }
  .overlay{ min-height:100%; background: rgba(255,255,255,.72); display:flex; align-items:center; justify-content:center; padding:2rem 1rem }
  .card{ width:100%; max-width:440px; background:#fff; border-radius:16px; box-shadow:0 10px 30px rgba(2,12,27,.18); padding:1.25rem }
  h1{ margin:.2rem 0 1rem; font-size:1.35rem }
  label{ display:block; margin:.45rem 0 .2rem; color:var(--muted); font-size:.92rem }
  input{ width:100%; padding:.6rem .7rem; border-radius:10px; border:2px solid #b3d4ff; box-sizing:border-box }
  input:focus{ outline:none; border-color:var(--primary); box-shadow:0 0 0 4px rgba(30,102,255,.25) }
  button{ margin-top:.9rem; width:100%; background:var(--primary); color:#fff; font-weight:700; padding:.65rem .9rem; border:0; border-radius:12px; cursor:pointer }
  .err{ background:#fee2e2; color:#991b1b; padding:.5rem .7rem; border-radius:10px; margin:.5rem 0; display:none }
  .ok{ background:#d1fadf; color:#065f46; padding:.5rem .7rem; border-radius:10px; margin:.5rem 0; display:none }
  .top{ display:flex; align-items:center; justify-content:space-between }
  a{ color:var(--primary); text-decoration:none }
  .muted{ color:var(--muted); font-size:.92rem; margin-top:.6rem; text-align:center }
</style>

<div class="overlay">
  <div class="card">
    <div class="top"><h1>Skapa konto</h1> <a href="/login">Logga in</a></div>
    <div id="err" class="err"></div>
    <div id="ok" class="ok">Konto skapat! Du kan nu logga in.</div>
    <form id="f">
      <label for="email">E‑post</label>
      <input id="email" type="email" autocomplete="email" required />
      <label for="pw">Lösenord (minst 12 tecken)</label>
      <input id="pw" type="password" autocomplete="new-password" minlength="12" required />
      <label for="pw2">Upprepa lösenord</label>
      <input id="pw2" type="password" autocomplete="new-password" minlength="12" required />
      <button type="submit">Registrera</button>
    </form>
    <div class="muted">Genom att skapa konto godkänner du våra villkor.</div>
  </div>
</div>

<script>
  const err = document.getElementById('err');
  const ok = document.getElementById('ok');
  document.getElementById('f').addEventListener('submit', async (e)=>{
    e.preventDefault(); err.style.display='none'; ok.style.display='none';
    const email = document.getElementById('email').value.trim();
    const pw = document.getElementById('pw').value;
    const pw2 = document.getElementById('pw2').value;
    if (!email || !pw || !pw2){ err.textContent='Fyll i alla fält.'; err.style.display='block'; return; }
    if (pw.length < 12){ err.textContent='Lösenordet måste vara minst 12 tecken.'; err.style.display='block'; return; }
    if (pw !== pw2){ err.textContent='Lösenorden matchar inte.'; err.style.display='block'; return; }
    const res = await fetch('/api/auth/register', { method:'POST', headers:{'Content-Type':'application/json'}, body: JSON.stringify({ email, password: pw, password_confirm: pw2 }) });
    if (!res.ok){ const t = await res.json().catch(()=>({error:'Registrering misslyckades'})); err.textContent = t.error||'Registrering misslyckades'; err.style.display='block'; return; }
    ok.style.display='block';
    // Redirect after a short delay
    setTimeout(()=> window.location = '/login', 900);
  });
</script>
</html>

